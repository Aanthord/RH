<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Post‑Cantorian RH — Single‑File Tester</title>
  <meta name="description" content="FTC/RSF falsifiability harness for RH — single‑file build" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@18.2.0/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/recharts@2.12.7/umd/Recharts.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone@7.25.6/babel.min.js"></script>
</head>
<body class="min-h-screen bg-neutral-100">
  <main class="max-w-7xl mx-auto p-6">
    <h1 class="text-3xl font-bold text-center mb-2">Post‑Cantorian RH Proof Tester</h1>
    <p class="text-center text-neutral-600 mb-6">FTC Recursive Integration · RSF Generation Symmetry · Single‑file</p>
    <div id="app"></div>
    <div id="diag" class="mt-4 mx-auto max-w-3xl text-xs text-neutral-600"></div>
    <footer class="mt-10 text-center text-xs text-neutral-500">
      Built savage‑style: one <code>index.html</code>. Powered by React + Recharts + Tailwind CDNs.
    </footer>
  </main>

  <script type="text/babel" data-presets="react,env">
    const { useState } = React;
    const { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, ReferenceLine } = Recharts;

    function RHProofTester() {
      const [energyData, setEnergyData] = useState([]);
      const [convexityData, setConvexityData] = useState([]);
      const [densityData, setDensityData] = useState([]);
      const [isComputing, setIsComputing] = useState(false);
      const [results, setResults] = useState("");
      const [maxDepth, setMaxDepth] = useState(20);
      const [tMax, setTMax] = useState(30);
      const [tau, setTau] = useState(0.001);

      const computeConfigurationSpace = depth => depth * depth + depth;
      const computeRecursiveRealizations = (_s, sigma, t, depth) => {
        const u = sigma - 0.5;
        const base = Math.exp(-Math.abs(u) * depth);
        const osc = Math.cos(t / Math.sqrt(depth + 1));
        const mod = 1 / (1 + depth / 10);
        const mult = Math.abs(u) > 0.01 ? 4 : 1;
        return Math.max(0.001, Math.abs(base * osc * mod) * mult);
      };
      const computeFractalDensity = (structure, sigma, t) => {
        let num = 0, den = 0;
        for (let i = 1; i <= maxDepth; i++) {
          const Fi = computeRecursiveRealizations(structure, sigma, t, i);
          const Gi = computeConfigurationSpace(i);
          const Di = Fi / Gi;
          const w = 1 / i;
          num += Di * w; den += w;
        }
        return num / den;
      };
      const computeRecursiveDerivative = (sigma, t, h = 1e-3) => {
        let num = 0, den = 0;
        for (let n = 1; n <= maxDepth; n++) {
          const Fn = computeRecursiveRealizations('zeta', sigma, t, n);
          const FnPlus = computeRecursiveRealizations('zeta', sigma + h, t, n);
          const Gn = computeConfigurationSpace(n);
          const GnPlus = computeConfigurationSpace(n + 1);
          const diff = (FnPlus - Fn) / (GnPlus - Gn + 1e-3);
          const w = 1 / n;
          num += diff * w; den += w;
        }
        return num / den;
      };
      const measure = t => Math.exp(-(t * t) / 100) * (1 + 0.1 * Math.sin(t / 5));
      const energy = (sigma, tMaxLocal = tMax, pts = 200) => {
        let acc = 0;
        const dt = (2 * tMaxLocal) / pts;
        for (let i = 0; i < pts; i++) {
          const t = -tMaxLocal + i * dt;
          const d = computeRecursiveDerivative(sigma, t);
          acc += d * d * measure(t) * computeFractalDensity('integration', sigma, t) * dt;
        }
        return acc;
      };
      const energySecond = (sigma, tauLocal = tau) => {
        const h = tauLocal;
        const Ep = energy(sigma + h);
        const E0 = energy(sigma);
        const Em = energy(sigma - h);
        const raw = (Ep - 2 * E0 + Em) / (h * h);
        return raw * Math.exp(-tauLocal * Math.abs(raw));
      };

      const run = () => {
        setIsComputing(true);
        setResults('Computing with FTC framework...\n');
        setTimeout(() => {
          const lines = [];
          lines.push('POST‑CANTORIAN RH PROOF FALSIFIABILITY TESTS');
          lines.push('=======================================================\n');
          lines.push(`Max Recursive Depth: ${maxDepth}`);
          lines.push(`tMax: ${tMax}, τ: ${tau}\n`);
          const sigmas = [0.1, 0.25, 0.4, 0.5, 0.6, 0.75, 0.9];
          const e = [];
          sigmas.forEach(s => { const v = energy(s, 20, 100); e.push({ sigma: s, energy: v }); lines.push(`E(${s}) = ${v.toFixed(6)}`); });
          setEnergyData(e);
          const c = [];
          lines.push('\nConvexity (E\'\'):');
          sigmas.forEach(s => { const v = energySecond(s); c.push({ sigma: s, secondDerivative: v }); lines.push(`E''(${s}) = ${v.toFixed(6)} ${v >= -0.1 ? '✓' : '✗'}`); });
          setConvexityData(c);
          const d = [];
          lines.push('\nFractal Density D_k(σ):');
          sigmas.forEach(s => { const v = computeFractalDensity('energy', s, 0); d.push({ sigma: s, density: v }); lines.push(`D_k(${s}) = ${v.toFixed(6)}`); });
          setDensityData(d);
          setResults(lines.join('\n'));
          setIsComputing(false);
        }, 60);
      };

      return (
        <div>
          <div className="mb-6 flex flex-wrap items-center gap-3 justify-center">
            <button onClick={run} disabled={isComputing} className="px-6 py-3 rounded-2xl shadow bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50">
              {isComputing ? 'Computing FTC…' : 'Run Tests'}
            </button>
            <label className="text-sm">Max Depth: <input type="number" min="5" max="50" value={maxDepth} onChange={e=>setMaxDepth(parseInt(e.target.value||'0',10))} className="w-20 px-2 py-1 border rounded ml-1"/></label>
          </div>
          <div className="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
            <ChartCard title="FTC Energy Functional E(σ)">
              <ResponsiveContainer width="100%" height={240}>
                <LineChart data={energyData}>
                  <CartesianGrid strokeDasharray="3 3" />
                  <XAxis dataKey="sigma" />
                  <YAxis />
                  <Tooltip />
                  <Legend />
                  <ReferenceLine x={0.5} stroke="#111827" strokeDasharray="4 4" label="σ = 1/2" />
                  <Line type="monotone" dataKey="energy" stroke="#6366f1" strokeWidth={2} dot={false} />
                </LineChart>
              </ResponsiveContainer>
            </ChartCard>
            <ChartCard title="Convexity E''(σ)">
              <ResponsiveContainer width="100%" height={240}>
                <LineChart data={convexityData}>
                  <CartesianGrid strokeDasharray="3 3" />
                  <XAxis dataKey="sigma" />
                  <YAxis />
                  <Tooltip />
                  <Legend />
                  <ReferenceLine x={0.5} stroke="#111827" strokeDasharray="4 4" label="σ = 1/2" />
                  <Line type="monotone" dataKey="secondDerivative" stroke="#10b981" strokeWidth={2} dot={false} />
                </LineChart>
              </ResponsiveContainer>
            </ChartCard>
            <ChartCard title="Fractal Density Dₖ(σ)">
              <ResponsiveContainer width="100%" height={240}>
                <LineChart data={densityData}>
                  <CartesianGrid strokeDasharray="3 3" />
                  <XAxis dataKey="sigma" />
                  <YAxis />
                  <Tooltip />
                  <Legend />
                  <ReferenceLine x={0.5} stroke="#111827" strokeDasharray="4 4" label="σ = 1/2" />
                  <Line type="monotone" dataKey="density" stroke="#f59e0b" strokeWidth={2} dot={false} />
                </LineChart>
              </ResponsiveContainer>
            </ChartCard>
          </div>
          <div className="p-4 bg-white rounded-xl border">
            <h3 className="text-lg font-semibold mb-2">Test Results</h3>
            <pre className="whitespace-pre-wrap text-sm font-mono bg-white p-4 rounded border overflow-auto max-h-96">{results || 'Click “Run Tests” to begin FTC analysis…'}</pre>
          </div>
        </div>
      );
    }

    const ChartCard = ({ title, children }) => (
      <div className="p-4 bg-white rounded-xl border">
        <h3 className="text-lg font-semibold mb-3">{title}</h3>
        {children}
      </div>
    );

    try {
      const mount = document.getElementById('app');
      const root = ReactDOM.createRoot(mount);
      root.render(<RHProofTester />);
      const d = document.getElementById('diag');
      if (d) d.innerHTML = `Diagnostics — React v${React.version} · Recharts: ${!!window.Recharts} · Babel: OK`;
    } catch (err) {
      console.error(err);
      const el = document.getElementById('app');
      if (el) el.innerHTML = `<div class="text-red-600">Failed to initialize app: ${String(err)}</div>`;
    }
  </script>
</body>
</html>
